<% expands('layouts/chimera');

Router.setBreadcrumb([
	{title: __('chimera', 'Dashboard'), route: 'chimera@Dashboard'},
	{title: pagetitle,                  route: 'chimera@ModelAction'}
]);

start('chimera-cage') %>
<div class="datalist page float-right">
	<div class="row">
		<div class="col-lg-3 col-md-3 col-sm-12 col-xs-12">
			<div class="records-preview datalist-preview">
				<% assign('record-peek') %>
					<div class="records-preview__cont">
						<div class="records-preview__note">
							<%= __('chimera', 'Select a record to enable preview') %>
						</div>
					</div>
				<% assign_end('record-peek') %>
			</div>
		</div>

		<div class="col-lg-9 col-md-9 col-sm-12 col-xs-12">
			<div class="panel panel-info">
				<div class="panel-heading">
					<h3 class="panel-title"><%= modelName.pluralize() %></h3>
					<div class="chimeraEditor-actions">
						<% Chimera.printActions('model-list', {className: 'btn btn-primary', variables: {force_inline: true}}, record) %>
					</div>
				</div>
				<div class="panel-body">
					<div class="datalist__result">
						<div class="container-fluid">
							<div class="dataTables_wrapper form-inline dt-bootstrap">
								<div class="row">
									<div class="col-sm-12">
										<table width="100%" data-orders="new" class="table datatable display table-hover dataTable" role="grid" aria-describedby="DataTables_Table_0_info" style="width: 100%;">
											<thead>
												<tr role="row">
													<%
													while (fields.hasNext()) {
														field = fields.next().value;

														print('<th>');
														print(Pagination.sort({field: field.path, content: field.fieldType.title}));
														print('</th>');
													}
													%>
												</tr>
												<tr class="filter-row">
													<%
													fields.reset();
													while (fields.hasNext()) {
														field = fields.next().value;

														print('<th>');
														print(Pagination.filter({field: field.path, content: field.fieldType.title, className: 'form-control'}));
														print('</th>');
													}
													%>
												</tr>
											</thead>
											<tbody>
												<%
													iterator = records.createIterator();
													while (iterator.hasNext()) {
														item = iterator.next();
														record = item.value;
														fields = record.fields;

														print('<tr class="model-list-record js-he-link" data-history="false" data-href="' + Router.routeUrl('RecordAction', {controller: 'editor', subject: modelName, action: 'peek', id: record.id}) + '">');

														for (i = 0; i < fields.length; i++) {
															print('<td>');
															Chimera.printField(fields[i]);
															print('</td>');
														}
														print('</tr>');
													}
												%>
											</tbody>
										</table>
									</div>
								</div>
								<div class="row">
									<div class="col-sm-5">
										<div class="dataTables_info" id="DataTables_Table_0_info" role="status" aria-live="polite">
											<%= __('chimera', 'Showing {first} to {last} of {total} records', {
												first : Pagination.getFirstOfPage(),
												last  : Pagination.getLastOfPage(),
												total : Pagination.getTotalItems()
											}) %>
										</div>
									</div>
									<div class="col-sm-7">
										<div class="dataTables_paginate paging_simple_numbers">
											<% Pagination.show() %>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<% end('chimera-cage') %>